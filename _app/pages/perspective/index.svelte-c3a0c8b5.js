import{N as t,O as e,P as n,Q as a,R as s,S as i,i as l,s as o,e as r,t as c,c as u,a as f,g as h,d as m,b as v,f as p,F as $,h as d,k as g,n as w,T as x,H as y,G as b,I as T,D as E,E as P,v as j,r as M,U as q,L as R,V as k,j as N,m as L,o as D,W as O,X as U,w as I,J as C,z as F,Y as S,Z as z}from"../../chunks/vendor-4d83dcfd.js";import{b as A}from"../../chunks/paths-7dc55c62.js";import{g as B,s as V}from"../../chunks/stores-30a9c379.js";class _{constructor(){this.viewPoints=null,this.realPoints=null,this.rawPoints=[null,null]}isFull(){return this.rawPoints.every((t=>null!=t))}add(n){if(this.isFull())throw Error("ruler full");n=t(e(this.viewTransform),n),null==this.rawPoints[0]?this.rawPoints[0]=n:this.rawPoints[1]=n}get2d(){if(null==this.viewPoints){const e=this.rawPoints.map((e=>e?t(this.viewTransform,e):null));this.viewPoints=e.map((t=>t?[t[0]/t[2],t[1]/t[2]]:null))}return[...this.viewPoints]}getReal2d(){if(null==this.realPoints){const e=this.rawPoints.map((e=>e?t(this.realTransform,e):null));this.realPoints=e.map((t=>t?[t[0]/t[2],t[1]/t[2]]:null))}return[...this.realPoints]}getMidPoint(){const t=this.get2d();return t[0].map(((e,n)=>(e+t[1][n])/2))}getLength(){if(!this.isFull())return 0;const t=this.getReal2d(),e=n(t[0],t[1]);return a(s(e,e))}setViewTransform(t){this.viewPoints=null,this.viewTransform=t}setRealTransform(t){this.realPoints=null,this.realTransform=t}}function Y(t){let e,n;return{c(){e=r("label"),n=c(t[2]),this.h()},l(a){e=u(a,"LABEL",{class:!0,for:!0});var s=f(e);n=h(s,t[2]),s.forEach(m),this.h()},h(){v(e,"class","label svelte-1yv36t6"),v(e,"for",t[1])},m(t,a){p(t,e,a),$(e,n)},p(t,a){4&a&&d(n,t[2]),2&a&&v(e,"for",t[1])},d(t){t&&m(e)}}}function G(t){let e,n,a,s,i,l,o,d,E,P,j,M=t[2]&&Y(t);return{c(){M&&M.c(),e=g(),n=r("div"),a=r("button"),s=c("−"),i=g(),l=r("input"),o=g(),d=r("button"),E=c("+"),this.h()},l(t){M&&M.l(t),e=w(t),n=u(t,"DIV",{class:!0});var r=f(n);a=u(r,"BUTTON",{class:!0});var c=f(a);s=h(c,"−"),c.forEach(m),i=w(r),l=u(r,"INPUT",{class:!0,type:!0,name:!0}),o=w(r),d=u(r,"BUTTON",{class:!0});var v=f(d);E=h(v,"+"),v.forEach(m),r.forEach(m),this.h()},h(){v(a,"class","btn decrease svelte-1yv36t6"),v(l,"class","input svelte-1yv36t6"),v(l,"type","text"),v(l,"name",t[1]),v(d,"class","btn increase svelte-1yv36t6"),v(n,"class","number-input svelte-1yv36t6")},m(r,c){M&&M.m(r,c),p(r,e,c),p(r,n,c),$(n,a),$(a,s),$(n,i),$(n,l),x(l,t[0]),$(n,o),$(n,d),$(d,E),P||(j=[y(a,"pointerdown",t[13]),y(a,"pointerup",t[6]),y(a,"pointerleave",t[6]),y(l,"input",t[14]),y(l,"change",t[15]),y(l,"pointerdown",t[7]),y(d,"pointerdown",t[16]),y(d,"pointerup",t[6]),y(d,"pointerleave",t[6])],P=!0)},p(t,[n]){t[2]?M?M.p(t,n):(M=Y(t),M.c(),M.m(e.parentNode,e)):M&&(M.d(1),M=null),2&n&&v(l,"name",t[1]),1&n&&l.value!==t[0]&&x(l,t[0])},i:b,o:b,d(t){M&&M.d(t),t&&m(e),t&&m(n),P=!1,T(j)}}}function W(t,e,n){let a,{initialvalue:s=0}=e,{name:i="name"}=e,{label:l=""}=e,{value:o=0}=e,{min:r=-100}=e,{max:c=100}=e,{step:u=1}=e,{quadratic:f=!1}=e,h=.8,m=null,v=null;function p(){a+=u*h,n(0,o=f?a*a*Math.sign(a):a),n(0,o=Math.min(o,c))}function $(){a-=u*h,n(0,o=f?a*a*Math.sign(a):a),n(0,o=Math.max(o,r))}function d(t){t(),m=setTimeout((function e(){t(),m=setTimeout(e,100)}),300),v=setTimeout((function t(){h*=2,v=setTimeout(t,1e3)}),1e3)}return t.$$set=t=>{"initialvalue"in t&&n(8,s=t.initialvalue),"name"in t&&n(1,i=t.name),"label"in t&&n(2,l=t.label),"value"in t&&n(0,o=t.value),"min"in t&&n(9,r=t.min),"max"in t&&n(10,c=t.max),"step"in t&&n(11,u=t.step),"quadratic"in t&&n(12,f=t.quadratic)},t.$$.update=()=>{4097&t.$$.dirty&&(a=f?Math.sqrt(Math.abs(o))*Math.sign(o):o)},[o,i,l,p,$,d,function(){h=1,clearTimeout(m),clearTimeout(v)},function(t){1==t.button&&(t.preventDefault(),n(0,o=s))},s,r,c,u,f,()=>d($),function(){o=this.value,n(0,o)},()=>n(0,o=+o||0),()=>d(p)]}class X extends i{constructor(t){super(),l(this,t,W,G,o,{initialvalue:8,name:1,label:2,value:0,min:9,max:10,step:11,quadratic:12})}}function H(t){let e,n,a,s,i;const l=t[2].default,o=E(l,t,t[1],null);return{c(){e=r("button"),o&&o.c(),this.h()},l(t){e=u(t,"BUTTON",{class:!0});var n=f(e);o&&o.l(n),n.forEach(m),this.h()},h(){v(e,"class",n="btn "+(t[0]?"active":"passive")+" svelte-1e4wm07")},m(n,l){p(n,e,l),o&&o.m(e,null),a=!0,s||(i=y(e,"click",t[3]),s=!0)},p(t,[s]){o&&o.p&&(!a||2&s)&&P(o,l,t,t[1],s,null,null),(!a||1&s&&n!==(n="btn "+(t[0]?"active":"passive")+" svelte-1e4wm07"))&&v(e,"class",n)},i(t){a||(j(o,t),a=!0)},o(t){M(o,t),a=!1},d(t){t&&m(e),o&&o.d(t),s=!1,i()}}}function J(t,e,n){let{$$slots:a={},$$scope:s}=e,{flag:i=!1}=e;return t.$$set=t=>{"flag"in t&&n(0,i=t.flag),"$$scope"in t&&n(1,s=t.$$scope)},[i,s,a,()=>n(0,i=!i)]}class K extends i{constructor(t){super(),l(this,t,J,H,o,{flag:0})}}let Z=new q.exports.GPU;function Q(n,a){const s=function(t){return Z.createKernel((function(t){return t[this.thread.y][this.thread.x]})).setOutput([t.width,t.height]).setPipeline(!0)(t)}(a),i=a.height,l=a.width,o=t(it(-l/i/2,.5),lt(1/i,-1/i));function r(t){return Z.createKernel("function (texture, transform) {\n\t\t\t\tconst v = [this.thread.x, this.thread.y, 1];\n\t\t\t\tconst tv = [0, 0, 0];\n\n\t\t\t\tfor (let i = 0; i < 3; i++) {\n\t\t\t\t\ttv[i] += transform[i][0] * v[0];\n\t\t\t\t\ttv[i] += transform[i][1] * v[1];\n\t\t\t\t\ttv[i] += transform[i][2] * v[2];\n\t\t\t\t}\n\n\t\t\t\tif (tv[2] === 0) {\n\t\t\t\t\tthis.color(0, 0, 0, 0);\n\t\t\t\t} else {\n\t\t\t\t\tconst x = Math.floor(tv[0] / tv[2]);\n\t\t\t\t\tconst y = Math.floor(tv[1] / tv[2]);\n\n\t\t\t\t\tif (y < 0 || y > this.constants.texH || x < 0 || x > this.constants.texW) {\n\t\t\t\t\t\tthis.color(0, 0, 0, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst pixel = texture[y][x];\n\t\t\t\t\t\tthis.color(pixel[0], pixel[1], pixel[2], pixel[3]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}").setConstants({texW:l,texH:i}).setOutput([t,t]).setGraphical(!0)}let c=r(n);c.destroy(!0),c=r(n);const u=t(it(-.5,.5),lt(1/n,-1/n));return{canvas:c.canvas,apply:a=>{var i,l;try{let n=t(e(t(a,o)),u);return c(s,n)}catch{null==(l=null==(i=c.canvas)?void 0:i.getContext("2d"))||l.clearRect(0,0,n,n)}}}}function tt(t){const e=Math.cos(t),n=Math.sin(t);return[[1,0,0,0],[0,e,-n,0],[0,n,e,0],[0,0,0,1]]}function et(t){const e=Math.cos(t),n=Math.sin(t);return[[e,0,n,0],[0,1,0,0],[-n,0,e,0],[0,0,0,1]]}function nt(t){const e=Math.cos(t),n=Math.sin(t);return[[e,-n,0,0],[n,e,0,0],[0,0,1,0],[0,0,0,1]]}function at(t,e,n){return[[1,0,0,t],[0,1,0,e],[0,0,1,n],[0,0,0,1]]}function st(t,e,n){return[[1,0,0,0],[0,1,0,0],[0,0,1,0],[-t,-e,-n,1]]}function it(t,e){return[[1,0,t],[0,1,e],[0,0,1]]}function lt(t,e){return[[t,0,0],[0,e,0],[0,0,1]]}function ot(n){const a=t(nt(+n.roll),t(et(+n.yaw),tt(+n.pitch))),s=t(at(0,0,+n.height),a);let i=t(e(s),[0,0,0,1]).flat();i=i.map((t=>t/i[3]));let l=[0,0,1,0];l=t(e(a),l).flat(),l=t(st(i[0],i[1],i[2]),l).flat();const[o,r,c,u]=l,f=n.focal,h=u+c*f;return[-o/h,-r/h,c*f/h]}function rt(n,a){const s=t(nt(+n.roll),t(et(+n.yaw),tt(+n.pitch))),i=t(at(0,0,+n.height),s);let l=t(e(i),[0,0,0,1]).flat();l=l.map((t=>t/l[3]));let o=[0,0,1,0];o=t(e(s),o).flat(),o=t(st(l[0],l[1],l[2]),o).flat();const r=function(t,e){const[n,a,s,i]=t;return[[-s*e-i,0,0],[0,-s*e-i,0],[e*n,e*a,i*e],[n,a,-s*e]]}(o,+n.focal),c=t([[1,0,0,0],[0,1,0,0],[0,0,0,1]],t(i,r));let u=t(c,[-a.x,+a.y,1]).flat();u=u.map((t=>t/u[2]));const f=it(-u[0],-u[1]);let h=t(f,c);return h=t([[1,0,0],[0,1,0],[0,0,1/+a.zoom]],h),h}function ct(t){let e;return{c(){e=c("Show original")},l(t){e=h(t,"Show original")},m(t,n){p(t,e,n)},d(t){t&&m(e)}}}function ut(t){let e;return{c(){e=c("Rulers")},l(t){e=h(t,"Rulers")},m(t,n){p(t,e,n)},d(t){t&&m(e)}}}function ft(t){let e,n,a,s,i,l,o,d,x,b,E,P,q,C,F,z,B,V,_,Y,G,W,H,J,Z,Q,tt,et,nt,at,st,it,lt,ot,rt,ft,ht,mt,vt,pt,$t,dt,gt,wt,xt,yt,bt,Tt,Et,Pt,jt,Mt,qt,Rt,kt,Nt;function Lt(e){t[18](e)}let Dt={label:"Zoom",name:"navigation-zoom",min:0,max:10,step:.1,initialvalue:1,quadratic:!0};function Ot(e){t[19](e)}void 0!==t[2].zoom&&(Dt.value=t[2].zoom),E=new X({props:Dt}),R.push((()=>k(E,"value",Lt)));let Ut={label:"X",name:"navigation-x",min:-1,max:1,step:.01};function It(e){t[20](e)}void 0!==t[2].x&&(Ut.value=t[2].x),C=new X({props:Ut}),R.push((()=>k(C,"value",Ot)));let Ct={label:"Y",name:"navigation-y",min:-1,max:1,step:.01};function Ft(e){t[21](e)}void 0!==t[2].y&&(Ct.value=t[2].y),B=new X({props:Ct}),R.push((()=>k(B,"value",It)));let St={label:"Focal length",name:"focal",min:0,max:10,step:.01,initialvalue:1,quadratic:!0};function zt(e){t[22](e)}void 0!==t[1].focal&&(St.value=t[1].focal),J=new X({props:St}),R.push((()=>k(J,"value",Ft)));let At={label:"Height",name:"height",min:0,max:15,step:.02,quadratic:!0};function Bt(e){t[23](e)}void 0!==t[1].height&&(At.value=t[1].height),tt=new X({props:At}),R.push((()=>k(tt,"value",zt)));let Vt={label:"Pitch",name:"pitch",min:-2*S,max:2*S,step:.01};function _t(e){t[24](e)}void 0!==t[1].pitch&&(Vt.value=t[1].pitch),at=new X({props:Vt}),R.push((()=>k(at,"value",Bt)));let Yt={label:"Yaw",name:"yaw",min:-2*S,max:2*S,step:.01};function Gt(e){t[25](e)}void 0!==t[1].yaw&&(Yt.value=t[1].yaw),lt=new X({props:Yt}),R.push((()=>k(lt,"value",_t)));let Wt={$$slots:{default:[ct]},$$scope:{ctx:t}};function Xt(e){t[26](e)}void 0!==t[0]&&(Wt.flag=t[0]),ft=new K({props:Wt}),R.push((()=>k(ft,"flag",Gt)));let Ht={$$slots:{default:[ut]},$$scope:{ctx:t}};return void 0!==t[5]&&(Ht.flag=t[5]),pt=new K({props:Ht}),R.push((()=>k(pt,"flag",Xt))),{c(){e=r("main"),n=r("div"),a=r("canvas"),s=c("This webapp requires javascript"),i=g(),l=r("div"),o=r("fieldset"),d=r("legend"),x=c("Navigation"),b=g(),N(E.$$.fragment),q=g(),N(C.$$.fragment),z=g(),N(B.$$.fragment),_=g(),Y=r("fieldset"),G=r("legend"),W=c("Camera"),H=g(),N(J.$$.fragment),Q=g(),N(tt.$$.fragment),nt=g(),N(at.$$.fragment),it=g(),N(lt.$$.fragment),rt=g(),N(ft.$$.fragment),mt=g(),vt=r("div"),N(pt.$$.fragment),dt=g(),gt=r("button"),wt=c("Clear"),xt=g(),yt=r("button"),bt=c("Save transform"),Tt=g(),Et=r("a"),Pt=c("Back"),jt=g(),Mt=r("a"),qt=c("hidden"),this.h()},l(t){e=u(t,"MAIN",{});var r=f(e);n=u(r,"DIV",{class:!0});var c=f(n);a=u(c,"CANVAS",{class:!0});var v=f(a);s=h(v,"This webapp requires javascript"),v.forEach(m),i=w(c),l=u(c,"DIV",{class:!0});var p=f(l);o=u(p,"FIELDSET",{class:!0});var $=f(o);d=u($,"LEGEND",{class:!0});var g=f(d);x=h(g,"Navigation"),g.forEach(m),b=w($),L(E.$$.fragment,$),q=w($),L(C.$$.fragment,$),z=w($),L(B.$$.fragment,$),$.forEach(m),_=w(p),Y=u(p,"FIELDSET",{class:!0});var y=f(Y);G=u(y,"LEGEND",{class:!0});var T=f(G);W=h(T,"Camera"),T.forEach(m),H=w(y),L(J.$$.fragment,y),Q=w(y),L(tt.$$.fragment,y),nt=w(y),L(at.$$.fragment,y),it=w(y),L(lt.$$.fragment,y),y.forEach(m),rt=w(p),L(ft.$$.fragment,p),mt=w(p),vt=u(p,"DIV",{class:!0});var P=f(vt);L(pt.$$.fragment,P),dt=w(P),gt=u(P,"BUTTON",{class:!0});var j=f(gt);wt=h(j,"Clear"),j.forEach(m),P.forEach(m),p.forEach(m),c.forEach(m),xt=w(r),yt=u(r,"BUTTON",{class:!0});var M=f(yt);bt=h(M,"Save transform"),M.forEach(m),Tt=w(r),Et=u(r,"A",{href:!0,class:!0,draggable:!0});var R=f(Et);Pt=h(R,"Back"),R.forEach(m),r.forEach(m),jt=w(t),Mt=u(t,"A",{hidden:!0,href:!0,download:!0});var k=f(Mt);qt=h(k,"hidden"),k.forEach(m),this.h()},h(){v(a,"class","viewer svelte-1s6btjo"),v(d,"class","svelte-1s6btjo"),v(o,"class","svelte-1s6btjo"),v(G,"class","svelte-1s6btjo"),v(Y,"class","svelte-1s6btjo"),v(gt,"class","btn svelte-1s6btjo"),v(vt,"class","row svelte-1s6btjo"),v(l,"class","drawer svelte-1s6btjo"),v(n,"class","with-drawer svelte-1s6btjo"),v(yt,"class","btn svelte-1s6btjo"),v(Et,"href",A+"/"),v(Et,"class","btn svelte-1s6btjo"),v(Et,"draggable","false"),Mt.hidden=!0,v(Mt,"href","."),v(Mt,"download","")},m(r,c){p(r,e,c),$(e,n),$(n,a),$(a,s),t[17](a),$(n,i),$(n,l),$(l,o),$(o,d),$(d,x),$(o,b),D(E,o,null),$(o,q),D(C,o,null),$(o,z),D(B,o,null),$(l,_),$(l,Y),$(Y,G),$(G,W),$(Y,H),D(J,Y,null),$(Y,Q),D(tt,Y,null),$(Y,nt),D(at,Y,null),$(Y,it),D(lt,Y,null),$(l,rt),D(ft,l,null),$(l,mt),$(l,vt),D(pt,vt,null),$(vt,dt),$(vt,gt),$(gt,wt),$(e,xt),$(e,yt),$(yt,bt),$(e,Tt),$(e,Et),$(Et,Pt),p(r,jt,c),p(r,Mt,c),$(Mt,qt),t[27](Mt),Rt=!0,kt||(Nt=[y(window,"pointerdown",t[7]),y(window,"pointerup",t[8]),y(window,"pointermove",t[9]),y(a,"wheel",O(t[10])),y(gt,"click",t[11]),y(yt,"click",t[6]),y(Et,"selectstart",O(t[16]))],kt=!0)},p(t,e){const n={};!P&&4&e[0]&&(P=!0,n.value=t[2].zoom,U((()=>P=!1))),E.$set(n);const a={};!F&&4&e[0]&&(F=!0,a.value=t[2].x,U((()=>F=!1))),C.$set(a);const s={};!V&&4&e[0]&&(V=!0,s.value=t[2].y,U((()=>V=!1))),B.$set(s);const i={};!Z&&2&e[0]&&(Z=!0,i.value=t[1].focal,U((()=>Z=!1))),J.$set(i);const l={};!et&&2&e[0]&&(et=!0,l.value=t[1].height,U((()=>et=!1))),tt.$set(l);const o={};!st&&2&e[0]&&(st=!0,o.value=t[1].pitch,U((()=>st=!1))),at.$set(o);const r={};!ot&&2&e[0]&&(ot=!0,r.value=t[1].yaw,U((()=>ot=!1))),lt.$set(r);const c={};128&e[1]&&(c.$$scope={dirty:e,ctx:t}),!ht&&1&e[0]&&(ht=!0,c.flag=t[0],U((()=>ht=!1))),ft.$set(c);const u={};128&e[1]&&(u.$$scope={dirty:e,ctx:t}),!$t&&32&e[0]&&($t=!0,u.flag=t[5],U((()=>$t=!1))),pt.$set(u)},i(t){Rt||(j(E.$$.fragment,t),j(C.$$.fragment,t),j(B.$$.fragment,t),j(J.$$.fragment,t),j(tt.$$.fragment,t),j(at.$$.fragment,t),j(lt.$$.fragment,t),j(ft.$$.fragment,t),j(pt.$$.fragment,t),Rt=!0)},o(t){M(E.$$.fragment,t),M(C.$$.fragment,t),M(B.$$.fragment,t),M(J.$$.fragment,t),M(tt.$$.fragment,t),M(at.$$.fragment,t),M(lt.$$.fragment,t),M(ft.$$.fragment,t),M(pt.$$.fragment,t),Rt=!1},d(n){n&&m(e),t[17](null),I(E),I(C),I(B),I(J),I(tt),I(at),I(lt),I(ft),I(pt),n&&m(jt),n&&m(Mt),t[27](null),kt=!1,T(Nt)}}}function ht(t,e){t.beginPath(),t.arc(e[0],e[1],3,0,6.3),t.stroke(),t.fill()}function mt(t,e,n){let a,s,i;C(t,V,(t=>n(33,i=t)));var l=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))((function(s,i){function l(t){try{r(a.next(t))}catch(e){i(e)}}function o(t){try{r(a.throw(t))}catch(e){i(e)}}function r(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,o)}r((a=a.apply(t,e||[])).next())}))};let o,r,c,u=!1,f=!1,h=null,m={height:0,focal:1,pitch:0,yaw:0,roll:0},v={x:0,y:0,zoom:.5},p=[],$=null;function d(){return l(this,void 0,void 0,(function*(){if(null===a)return r.canvas.getContext("2d").clearRect(0,0,r.canvas.width,r.canvas.height),void setTimeout(d);a!==h?(h=a,r.apply(a),setTimeout(d)):setTimeout(d)}))}function g(){if(!o)return void requestAnimationFrame(g);n(3,o.width=o.clientWidth,o),n(3,o.height=o.clientWidth,o);const t=o.getContext("2d");t.clearRect(0,0,o.width,o.height),t.drawImage(r.canvas,0,0,o.width,o.height),t.strokeStyle="#0f0",t.fillStyle="#0f0",t.font="24px Arial",p.forEach((e=>{let n=e.get2d();n=n.map((t=>t.map((t=>(t+.5)*o.height)))),n.forEach((e=>ht(t,e))),t.beginPath(),t.moveTo(n[0][0],n[0][1]),t.lineTo(n[1][0],n[1][1]),t.stroke();const a=e.getMidPoint().map((t=>(t+.5)*o.height));t.fillText(`${e.getLength().toFixed(2)}m`,a[0]-24,a[1])})),$&&ht(t,$.get2d()[0].map((t=>(t+.5)*o.height))),requestAnimationFrame(g)}var w,x;(x=w||(w={}))[x.left=0]="left",x[x.right=1]="right";let y=null,b={x:0,y:0};return F((()=>{try{let t=function(t){r=Q(1080,t),setTimeout(d),requestAnimationFrame(g)};const e=i.imgData;if(!e)throw new ReferenceError("No image found in session");const n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0);const a=new Image;a.onload=e=>{t(a),a.remove(),n.remove()},a.src=n.toDataURL()}catch(t){return B(`${A}/`)}})),t.$$.update=()=>{7&t.$$.dirty[0]&&n(14,a=u?[[1,0,0],[0,1,0],[0,0,2]]:rt(Object.assign(Object.assign({},m),{height:0}),v)),2&t.$$.dirty[0]&&n(15,s=rt(m,{x:0,y:0,zoom:1})),28672&t.$$.dirty[0]&&(p.forEach((t=>t.setViewTransform(a))),null==$||$.setViewTransform(a)),36864&t.$$.dirty[0]&&p.forEach((t=>t.setRealTransform(s)))},[u,m,v,o,c,f,function(){let t=i.name;t=t.replace(/\.\w*$/,"_view.json");const e={camera:m,projection:s,invscale:ot(m)},a=new Blob([JSON.stringify(e,null,2)],{type:"application.json"}),l=URL.createObjectURL(a);n(4,c.href=l,c),n(4,c.download=t,c),c.click(),URL.revokeObjectURL(l)},function(t){if(!o)return;const e=o.getBoundingClientRect();if(b.x=t.clientX,b.y=t.clientY,!(b.x<e.left||b.x>e.right||b.y<e.top||b.y>e.bottom))switch(t.button){case 0:if(y=w.left,f){!function(t,e){const i=[t,e,1];null!=$?($.add(i),$.setRealTransform(s),p.push($),n(13,$=null)):(n(13,$=new _),$.setViewTransform(a),$.add(i))}((b.x-e.left)/o.height-.5,(b.y-e.top)/o.height-.5)}break;case 2:y=w.right;break;default:y=null}},function(t){y=null},function(t){f||y!=w.left||(n(1,m.pitch+=.001*(t.clientY-b.y),m),n(1,m.yaw-=.001*(t.clientX-b.x),m),b.x=t.clientX,b.y=t.clientY)},function(t){let e=Math.sqrt(Math.abs(m.focal))*Math.sign(m.focal);e-=5e-4*t.deltaY,n(1,m.focal=e*e*Math.sign(e),m)},function(){n(12,p=[]),n(13,$=null)},p,$,a,s,function(e){z(t,e)},function(t){R[t?"unshift":"push"]((()=>{o=t,n(3,o)}))},function(e){t.$$.not_equal(v.zoom,e)&&(v.zoom=e,n(2,v))},function(e){t.$$.not_equal(v.x,e)&&(v.x=e,n(2,v))},function(e){t.$$.not_equal(v.y,e)&&(v.y=e,n(2,v))},function(e){t.$$.not_equal(m.focal,e)&&(m.focal=e,n(1,m))},function(e){t.$$.not_equal(m.height,e)&&(m.height=e,n(1,m))},function(e){t.$$.not_equal(m.pitch,e)&&(m.pitch=e,n(1,m))},function(e){t.$$.not_equal(m.yaw,e)&&(m.yaw=e,n(1,m))},function(t){u=t,n(0,u)},function(t){f=t,n(5,f)},function(t){R[t?"unshift":"push"]((()=>{c=t,n(4,c)}))}]}export default class extends i{constructor(t){super(),l(this,t,mt,ft,o,{},[-1,-1])}}
